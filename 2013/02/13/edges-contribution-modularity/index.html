
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="author" content="Timothée Poisot" />
    <title>Tim Poisot :: Estimating edges contribution to network properties</title>

    <link rel="stylesheet" href="/assets/themes/thescientist/css/core.css" media="screen"/> 
    <link rel="stylesheet" href="/assets/themes/thescientist/css/mobile.css" media="handheld, only screen and (max-device-width:480px)"/>
    <link rel="stylesheet" href="/assets/themes/thescientist/css/pygment.css" />
    
    <script type="text/javascript" src="//use.typekit.net/kvz6lyh.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
    <script src="http://d3js.org/d3.v3.min.js"></script>

    
      <link rel="alternate" type="application/atom+xml" title="RSS Feed for Tim's blog" href="http://feeds.feedburner.com/timpoisot" />
    

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11830706-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </head>
  <body>
    <div class="wrapper">
      <div class='precontent'>
        <div class='siteinfos'>
          <h1><a href="http://timotheepoisot.fr">Tim <span class='thl'>Poisot</span></a></h1>
          <div class='nav'>
          <ul class='main-nav'>
            <li><a class="extra navlink homelink" href="/">About</a></li>
            <li><a class="extra navlink reslink" href="/research/">Research</a></li>
            <li><a class="extra navlink paplink" href="/papers/">Papers</a></li>
            <li><a class="extra navlink codelink" href="/code/">Code</a></li>     
            <li><a class="extra navlink bloglink" href="/blog/">Blog</a></li>
          </ul>
        </div>
        </div>
      </div>

      <section class='content'>
      
<section>
	<div class='pbody'>

		<h1 class='ptitle'>Estimating edges contribution to network properties</h1>
		<span class='margin'>
			February 13, 2013<br />
			553 words <br />	
			Taggs:
			
				<a class='post-tag' href="/tags/#ecological networks-ref" title="tag">ecological networks</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#modularity-ref" title="tag">modularity</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#open lab book-ref" title="tag">open lab book</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#python-ref" title="tag">python</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#networkx-ref" title="tag">networkx</a>,&nbsp;
			
				<a class='post-tag' href="/tags/#D3.js-ref" title="tag">D3.js</a>
			
		</span>

		<p>I had so much fun writing the previous post about how it is possible to measure <a href="/2013/02/12/species-contribution-modularity/">nodes contribution to network properties</a> that I wanted to see what happens when you remove edges. Also, I spent two hours this afternoon playing with <a href="http://d3js.org/"><code>D3.js</code></a>, and I wanted to put what I've learnt in practice.</p>

<p>What I want to do is remove each <em>edge</em>, and see how it affects modularity. This is, once again, really easy to do in <code>networkx</code>. We'll just write a function similar to <code>removeNode</code>, and add the possibility to keep the nodes with no links, or to remove them. By default, I'll consider that any node with no remaining edge is removed.</p>

<div class="highlight"><pre><code class="python"><span class="k">def</span> <span class="nf">removeEdge</span><span class="p">(</span><span class="n">web</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="n">nozero</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">tempWeb</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
    <span class="n">tempWeb</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">web</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
    <span class="n">tempWeb</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">web</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
    <span class="n">tempWeb</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">([</span><span class="n">edge</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">nozero</span><span class="p">:</span>
        <span class="n">Isolated</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">tempWeb</span> <span class="k">if</span> <span class="n">tempWeb</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">tempWeb</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">(</span><span class="n">Isolated</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tempWeb</span>
</code></pre>
</div>


<p>To get the contribution of each edge to modularity, it's simple to just adapt the one-liner from the previous post into:</p>

<div class="highlight"><pre><code class="python"><span class="n">delta_mod</span> <span class="o">=</span> <span class="p">[</span><span class="n">orig_mod</span><span class="o">-</span><span class="n">getModularity</span><span class="p">(</span><span class="n">removeEdge</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">e</span><span class="p">))</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]</span>
</code></pre>
</div>


<p><span class='margin'>The ranking method I use (<code>rankdata</code> in <code>scipy</code>) averages the rank of tied elements. So that explains why the points are not evely spaced.</span>OK, so let's see what it looks like:</p>

<div class='edgecontrib scatterplot d3'></div>


<!-- edgecontrib-rank.tsv -->


<script type="text/javascript" src="/data/edgecontrib-scatter.js"></script>


<p>The values of &Delta; are low, but the message is simple: most edges, when removed, make modularity <em>decrease</em>. For the next step, it can be cool to visualize <em>where</em> in the networks these nodes are. <code>D3.js</code> is able to read <code>JSON</code> files to plot them as networks. So we just need to write a quick and dirty converter from , <code>networkx</code> to <code>JSON</code>, and tweak <a href="http://bl.ocks.org/4062045">this example</a>.</p>

<p><span class='margin'>And it's <a href="/2012/11/23/how-to-represent-networks/">a good idea</a> to use <code>JSON</code> to represent networks...</span>This is so quick and dirty that I won't reproduce it here, but I ended up with a <code>JSON</code> file containing the edges, and the nodes. For each node, the module it belongs to is known. For each edge, its contribution to modularity is known. What remains to do is to plot everything, thanks to the power of <code>D3.js</code>.</p>

<div class='edgecolor network d3'></div>


<!-- edgecontrib-rank.tsv -->


<script type="text/javascript" src="/data/edgecontrib-network.js"></script>


<p>In this plot (move the nodes around!), the red links decrease modularity when removed, and the blue links increase it. The color of the nodes reflect which module they belong to. A quick eyeballing of the graph shows that blue links are established between nodes sharing different modules. Which makes sense, as if you disconnect modules, you further increase modularity. It may look good, but it's not rocket science!</p>

<p>In any case, I'm quite happy about the whole thing. First, it's super straightforward to remove edges/nodes with <code>networkx</code>, and to measure how it affects network structure. Second, it's fast enough even on networks of a respectable size. And finally, this is perhaps the biggest revelation of the day: it's <em>easy</em> to use <code>D3.js</code>. It may not seem like much, but the two figures in this blog post are generated <em>from the original data</em>. So if I want to re-generate the data, the figures will change as well. There is even more potential when creating webpages for projects, so I'll look more into that.</p>


		<div id="page-navigation">

        		<div class="left">
	        		
	                	Previous post: <a href="/2013/02/12/species-contribution-modularity/" title="Previous Post: Estimating node contribution to network properties">Estimating node contribution to network properties</a>
	        		
        		</div>

		        <div class="right">
			        
		        </div>
		</div> 

		


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'tpoi-hp'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




	</div>
</section>
<span
	class="Z3988" 
	title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc&amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator&amp;rft.title=Estimating edges contribution to network properties&amp;rft.creator=Timothée Poisot&amp;rft.date=2013-02-13&amp;rft.language=EN&amp;rft.rights=CC-BY-SA&amp;rft_id=http://timotheepoisot.fr/2013/02/13/edges-contribution-modularity/">
</span>

      </section>

      <div class='footer'>
          <p>
            This website uses <a href="http://jekyllbootstrap.com/">Jekyll Bootstrap</a> and is hosted at <a href="http://pages.github.com/">GitHub pages</a>.<p />
            The contents of this website are under the <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons</a> BY-SA licence 3.0.
          </p>
      </div>
      
    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>

